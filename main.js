(()=>{"use strict";const t=[{url:"./PNG/black-friday-banner.png"},{url:"./PNG/top-10-banner.png"},{url:"./PNG/cozy-books-banner.png"}],e=document.querySelector(".slider-images"),i=document.querySelector(".slider-dots");function o(t){e.querySelector(".active").classList.remove("active"),e.querySelector(".n"+t).classList.add("active"),i.querySelector(".active").classList.remove("active"),i.querySelector(".n"+t).classList.add("active")}class s{constructor(t,e){this.data=t,this.cover=t.volumeInfo.imageLinks?.thumbnail||"/PNG/default-book-cover.png",this.authors=t.volumeInfo.authors,this.title=t.volumeInfo.title,this.rating=t.volumeInfo.averageRating,this.ratingCount=t.volumeInfo.ratingsCount,this.description=t.volumeInfo.description,this.price=t.saleInfo.retailPrice,this.item=document.querySelector(".book-card-template").content.cloneNode(!0),this.config=e,this.inCart=!1,this.buyButton=this.item.querySelector(".library-button"),this.id=t.id}fillData(){this.ratingCount&&this.rating?(this.item.querySelector(".book-card__rating_reviews").textContent=this.ratingCount+" review",this.fillStars()):(this.item.querySelector(".book-card__rating").remove(),this.ratingCount=null,this.rating=null),(JSON.parse(localStorage.getItem("buyButton"))||[]).forEach((t=>{this.inCart=this.id===t.id?t.inCart:this.inCart})),this.inCart?(this.buyButton.classList.add("in-the-cart-button"),this.buyButton.textContent="in the cart"):this.price||(this.buyButton.disabled=!0,this.buyButton.classList.add("in-the-cart-button"),this.buyButton.textContent="not for sale",this.buyButton.style.cursor="default"),this.item.querySelector(".book-card__cover-image").src=this.cover,this.item.querySelector(".book-card__text_author").textContent=this.authors?.join(", "),this.item.querySelector(".book-card__text_title").textContent=this.title,this.item.querySelector(".book-card__text_description-content").textContent=this.description,this.item.querySelector(".book-card__text_price").textContent=this.price?`${this.price.amount} ${this.price.currencyCode}`:"NOT FOR SALE"}fillStars(){const t=this.item.querySelector(".book-card__rating_stars");for(let e=1;e<=5;e++)e<=Math.round(this.rating)?t.innerHTML+='<img class="star-icon" src="./SVG/Star-yellow.svg" alt="Star-yellow">':t.innerHTML+='<img class="star-icon" src="./SVG/Star-white.svg" alt="Star-white">'}addToCart(){this.buyButton.classList.toggle("in-the-cart-button");const t=document.querySelector(".cart-counter");this.inCart?(this.buyButton.textContent="buy now",this.config.cart--):(this.buyButton.textContent="in the cart",this.config.cart++),this.inCart=!this.inCart,t.textContent=this.config.cart,0==+this.config.cart?t.style.display="none":t.style.display="block",this.setLocalStorage()}setLocalStorage(){let t=JSON.parse(localStorage.getItem("buyButton"))||[];t.length&&(t=t.filter((t=>this.id!==t.id))),t.push({id:this.id,inCart:this.inCart}),localStorage.setItem("cart",this.config.cart.toString()),localStorage.setItem("buyButton",JSON.stringify(t))}render(){this.buyButton.addEventListener("click",(()=>{this.addToCart()})),this.fillData(),document.querySelector(".book-list").append(this.item)}}const r={end:6,cart:+localStorage.getItem("cart")||0},n=new class{getBooks(t=6,e="Architecture"){return fetch(`https://www.googleapis.com/books/v1/volumes?q="subject:${e}"&key=AIzaSyBUarFRhwharvvrJeC2ZInNHv6koojssmM&printType=books&startIndex=0&maxResults=${t}&langRestrict=en`).then((t=>t.ok?t.json():Promise.reject(t.status)))}},a=new class{constructor(t,e,i){this.render=e,this.bookList=document.querySelector(".book-list"),this.category="Architecture",this.setBooks=t,this.config=i}setListeners(){const t=document.querySelector(".load-more-button");document.querySelectorAll(".category-list__link").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.category=e.target.dataset.category,this.config.end=6,t.style.display="block",this.setBooks(this.category),document.querySelector(".category-list__item.active").classList.remove("active"),e.target.parentNode.classList.add("active")}))})),t.addEventListener("click",(t=>{this.config.end+6>40?(this.config.end+=40-this.config.end,t.target.style.display="none"):this.config.end+=6,this.setBooks(this.category)}))}renderBooks(t){console.log(t),this.bookList.innerHTML="",t.forEach((t=>{this.render(t)}))}}((function(t){n.getBooks(r.end,t).then((({items:t})=>{a.renderBooks(t)})).catch((t=>{console.log(t)}))}),(function(t){new s(t,r).render()}),r),c=document.querySelector(".cart-counter");a.setListeners(),c.textContent=localStorage.getItem("cart")||0,0==+c.textContent?c.style.display="none":c.style.display="block",a.setBooks("Architecture"),document.addEventListener("DOMContentLoaded",(function(){t&&t.length&&(t.forEach(((i,o)=>{const s=`<div class="image n${o} ${0===o?"active":""}" style="background-image:url(${t[o].url});" data-index="${o}"></div>`;e.innerHTML+=s})),t.forEach(((t,e)=>{const o=`<div class="slider__dots-item n${e} ${0===e?"active":""}" data-index="${e}"></div>`;i.innerHTML+=o})),i.querySelectorAll(".slider__dots-item").forEach((t=>{t.addEventListener("click",(function(){o(this.dataset.index),i.querySelector(".active").classList.remove("active"),this.classList.add("active")}))})),setInterval((()=>{const i=+e.querySelector(".active").dataset.index;o(i===t.length-1?0:i+1)}),5e3))}))})();